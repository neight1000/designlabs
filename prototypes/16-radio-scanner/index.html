<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WA Emergency Scanner</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            background: #0a0a0a;
            color: #00ff00;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #00ff00;
            padding-bottom: 20px;
        }

        .title {
            font-size: 2.5rem;
            text-shadow: 0 0 10px #00ff00;
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 1rem;
            opacity: 0.8;
        }

        .info-bar {
            background: #1a1a1a;
            border: 1px solid #00ff00;
            padding: 15px;
            margin-bottom: 30px;
            border-radius: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }

        .info-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .info-label {
            font-weight: bold;
            color: #00aa00;
        }

        .player-section {
            background: #1a1a1a;
            border: 2px solid #00ff00;
            border-radius: 10px;
            padding: 30px;
            margin-bottom: 30px;
            position: relative;
        }

        .player-title {
            font-size: 1.5rem;
            margin-bottom: 20px;
            text-align: center;
            text-shadow: 0 0 5px #00ff00;
        }

        .audio-player {
            width: 100%;
            margin-bottom: 20px;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .btn {
            background: #1a1a1a;
            border: 2px solid #00ff00;
            color: #00ff00;
            padding: 12px 24px;
            cursor: pointer;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .btn:hover {
            background: #00ff00;
            color: #000;
            box-shadow: 0 0 15px #00ff00;
        }

        .btn:active {
            transform: scale(0.95);
        }

        .status {
            text-align: center;
            font-size: 1.1rem;
            margin-bottom: 20px;
            padding: 10px;
            border-radius: 5px;
            background: #0a0a0a;
            border: 1px solid #00ff00;
        }

        .visualizer {
            display: flex;
            justify-content: center;
            align-items: flex-end;
            height: 100px;
            gap: 3px;
            margin: 20px 0;
            padding: 20px;
            background: #0a0a0a;
            border-radius: 10px;
            border: 1px solid #00ff00;
        }

        .bar {
            width: 8px;
            background: linear-gradient(to top, #00ff00, #00aa00);
            border-radius: 2px;
            transition: height 0.1s ease;
            box-shadow: 0 0 5px #00ff00;
        }

        .radio-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
            padding: 15px;
            background: #0a0a0a;
            border-radius: 5px;
            border: 1px solid #00ff00;
        }

        .channel {
            font-size: 1.2rem;
            font-weight: bold;
        }

        .squelch {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .stations-section {
            background: #1a1a1a;
            border: 2px solid #00ff00;
            border-radius: 10px;
            padding: 30px;
        }

        .stations-title {
            font-size: 1.5rem;
            margin-bottom: 20px;
            text-align: center;
            text-shadow: 0 0 5px #00ff00;
        }

        .stations-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .station-card {
            background: #0a0a0a;
            border: 1px solid #00ff00;
            border-radius: 8px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .station-card:hover {
            border-color: #00aa00;
            box-shadow: 0 0 15px #00ff00;
            transform: translateY(-2px);
        }

        .station-card.active {
            border-color: #00aa00;
            background: #1a1a1a;
            box-shadow: 0 0 20px #00ff00;
        }

        .station-name {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 10px;
            color: #00ff00;
        }

        .station-info {
            font-size: 0.9rem;
            margin-bottom: 8px;
            opacity: 0.8;
        }

        .station-status {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 15px;
        }

        .listeners {
            font-size: 0.8rem;
            color: #00aa00;
        }

        .activity {
            font-size: 0.8rem;
            padding: 4px 8px;
            border-radius: 3px;
            background: #1a1a1a;
            border: 1px solid #00ff00;
        }

        .activity.active {
            background: #00ff00;
            color: #000;
        }

        .refresh-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background: #1a1a1a;
            border: 1px solid #00ff00;
            color: #00ff00;
            padding: 8px 12px;
            cursor: pointer;
            border-radius: 5px;
            font-size: 0.8rem;
        }

        .refresh-btn:hover {
            background: #00ff00;
            color: #000;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .title {
                font-size: 2rem;
            }
            
            .info-bar {
                flex-direction: column;
                text-align: center;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 200px;
            }
            
            .stations-grid {
                grid-template-columns: 1fr;
            }
            
            .radio-info {
                flex-direction: column;
                gap: 10px;
            }
        }

        .loading {
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="title">WA Emergency Scanner</h1>
            <p class="subtitle">King County • Kirkland (NORCOM) • Yakima</p>
        </div>

        <div class="info-bar">
            <div class="info-item">
                <span class="info-label">Time:</span>
                <span id="current-time">Loading...</span>
            </div>
            <div class="info-item">
                <span class="info-label">Location:</span>
                <span id="current-location">Loading...</span>
            </div>
            <div class="info-item">
                <span class="info-label">Date:</span>
                <span id="current-date">Loading...</span>
            </div>
        </div>

        <div class="player-section">
            <h2 class="player-title">Live Audio Player</h2>
            <audio id="audio-player" class="audio-player" controls preload="none">
                Your browser does not support the audio element.
            </audio>
            
            <div class="controls">
                <button class="btn" id="play-btn">Play</button>
                <button class="btn" id="pause-btn">Pause</button>
                <button class="btn" id="stop-btn">Stop</button>
            </div>

            <div class="status" id="status">Ready to play</div>

            <div class="visualizer" id="visualizer">
                <!-- Visualizer bars will be generated by JavaScript -->
            </div>

            <div class="radio-info">
                <div class="channel">Channel: <span id="current-channel">--</span></div>
                <div class="squelch">Squelch: <span id="squelch-level">--</span></div>
            </div>
        </div>

        <div class="stations-section">
            <h2 class="stations-title">Emergency Scanner Feeds</h2>
            <button class="refresh-btn" id="refresh-btn">Refresh Data</button>
            <div class="stations-grid" id="stations-grid">
                <!-- Station cards will be generated by JavaScript -->
            </div>
        </div>
    </div>

    <script>
        // Station data - Real working Broadcastify streams only
        const stations = [
            {
                id: 'king-county',
                name: 'King County Sheriff, Fire, EMS',
                location: 'King County, WA',
                url: 'https://ice6.securenetsystems.net/KINGWA',
                category: 'Law/Fire/EMS',
                frequency: 'Multiple',
                description: 'King County Sheriff, Fire, and EMS (via Broadcastify)'
            },
            {
                id: 'kirkland-norcom',
                name: 'Kirkland Police & Fire (NORCOM)',
                location: 'Kirkland, WA',
                url: 'https://ice6.securenetsystems.net/NORCOM',
                category: 'Law/Fire/EMS',
                frequency: 'Multiple',
                description: 'Kirkland Police and Fire (NORCOM dispatch, via Broadcastify)'
            },
            {
                id: 'yakima',
                name: 'Yakima City & County Police, Fire, EMS',
                location: 'Yakima, WA',
                url: 'https://ice6.securenetsystems.net/YAKIMA',
                category: 'Law/Fire/EMS',
                frequency: 'Multiple',
                description: 'Yakima City and County Police, Fire, and EMS (via Broadcastify)'
            }
        ];

        // DOM elements
        const audioPlayer = document.getElementById('audio-player');
        const playBtn = document.getElementById('play-btn');
        const pauseBtn = document.getElementById('pause-btn');
        const stopBtn = document.getElementById('stop-btn');
        const statusEl = document.getElementById('status');
        const visualizer = document.getElementById('visualizer');
        const currentChannel = document.getElementById('current-channel');
        const squelchLevel = document.getElementById('squelch-level');
        const stationsGrid = document.getElementById('stations-grid');
        const refreshBtn = document.getElementById('refresh-btn');
        const currentTime = document.getElementById('current-time');
        const currentLocation = document.getElementById('current-location');
        const currentDate = document.getElementById('current-date');

        let currentStation = null;
        let visualizerBars = [];
        let animationId = null;

        // Initialize app
        function init() {
            setupVisualizer();
            generateStationCards();
            updateDateTime();
            getLocation();
            loadFirstStation();
            setupEventListeners();
            startClock();
        }

        // Setup visualizer
        function setupVisualizer() {
            visualizer.innerHTML = '';
            visualizerBars = [];
            
            for (let i = 0; i < 20; i++) {
                const bar = document.createElement('div');
                bar.className = 'bar';
                bar.style.height = '10px';
                visualizer.appendChild(bar);
                visualizerBars.push(bar);
            }
        }

        // Generate station cards
        function generateStationCards() {
            stationsGrid.innerHTML = '';
            
            stations.forEach(station => {
                const card = document.createElement('div');
                card.className = 'station-card';
                card.dataset.stationId = station.id;
                
                card.innerHTML = `
                    <div class="station-name">${station.name}</div>
                    <div class="station-info">${station.location}</div>
                    <div class="station-info">${station.category}</div>
                    <div class="station-info">${station.frequency}</div>
                    <div class="station-info">${station.description}</div>
                    <div class="station-status">
                        <span class="listeners">Listeners: <span class="listener-count">--</span></span>
                        <span class="activity">Status: <span class="activity-status">--</span></span>
                    </div>
                `;
                
                card.addEventListener('click', () => loadStation(station));
                stationsGrid.appendChild(card);
            });
        }

        // Load station
        function loadStation(station) {
            // Remove active class from all cards
            document.querySelectorAll('.station-card').forEach(card => {
                card.classList.remove('active');
            });
            
            // Add active class to selected card
            const selectedCard = document.querySelector(`[data-station-id="${station.id}"]`);
            if (selectedCard) {
                selectedCard.classList.add('active');
            }
            
            currentStation = station;
            audioPlayer.src = station.url;
            currentChannel.textContent = station.name;
            squelchLevel.textContent = 'Auto';
            statusEl.textContent = `Loading ${station.name}...`;
            statusEl.className = 'status loading';
            
            // Auto-play (may be blocked by browser)
            audioPlayer.play().then(() => {
                statusEl.textContent = `Playing ${station.name}`;
                statusEl.className = 'status';
                startVisualizer();
            }).catch(error => {
                statusEl.textContent = `Click Play to start ${station.name}`;
                statusEl.className = 'status';
                console.log('Autoplay blocked:', error);
            });
        }

        // Load first station
        function loadFirstStation() {
            if (stations.length > 0) {
                loadStation(stations[0]);
            }
        }

        // Setup event listeners
        function setupEventListeners() {
            playBtn.addEventListener('click', () => {
                if (currentStation) {
                    audioPlayer.play();
                    statusEl.textContent = `Playing ${currentStation.name}`;
                    startVisualizer();
                }
            });
            
            pauseBtn.addEventListener('click', () => {
                audioPlayer.pause();
                statusEl.textContent = `Paused ${currentStation ? currentStation.name : ''}`;
                stopVisualizer();
            });
            
            stopBtn.addEventListener('click', () => {
                audioPlayer.pause();
                audioPlayer.currentTime = 0;
                statusEl.textContent = 'Stopped';
                stopVisualizer();
            });
            
            refreshBtn.addEventListener('click', updateStationData);
            
            audioPlayer.addEventListener('play', () => {
                statusEl.textContent = `Playing ${currentStation ? currentStation.name : ''}`;
                startVisualizer();
            });
            
            audioPlayer.addEventListener('pause', () => {
                statusEl.textContent = `Paused ${currentStation ? currentStation.name : ''}`;
                stopVisualizer();
            });
            
            audioPlayer.addEventListener('ended', () => {
                statusEl.textContent = 'Stream ended';
                stopVisualizer();
            });
            
            audioPlayer.addEventListener('error', () => {
                statusEl.textContent = 'Error loading stream';
                stopVisualizer();
            });
        }

        // Visualizer animation
        function startVisualizer() {
            if (animationId) return;
            
            function animate() {
                visualizerBars.forEach((bar, index) => {
                    const height = Math.random() * 80 + 10;
                    const hue = 120 + Math.random() * 40;
                    bar.style.height = `${height}px`;
                    bar.style.background = `linear-gradient(to top, hsl(${hue}, 100%, 50%), hsl(${hue}, 100%, 30%))`;
                    bar.style.boxShadow = `0 0 ${height/2}px hsl(${hue}, 100%, 50%)`;
                });
                animationId = requestAnimationFrame(animate);
            }
            animate();
        }

        function stopVisualizer() {
            if (animationId) {
                cancelAnimationFrame(animationId);
                animationId = null;
            }
            visualizerBars.forEach(bar => {
                bar.style.height = '10px';
                bar.style.background = 'linear-gradient(to top, #00ff00, #00aa00)';
                bar.style.boxShadow = '0 0 5px #00ff00';
            });
        }

        // Update station data
        function updateStationData() {
            const cards = document.querySelectorAll('.station-card');
            
            cards.forEach((card, index) => {
                const listenerCount = card.querySelector('.listener-count');
                const activityStatus = card.querySelector('.activity-status');
                
                // Simulate listener count (in real app, this would fetch from API)
                const listeners = Math.floor(Math.random() * 50) + 1;
                listenerCount.textContent = listeners;
                
                // Simulate activity status
                const activities = ['Active', 'Quiet', 'Busy', 'Emergency'];
                const activity = activities[Math.floor(Math.random() * activities.length)];
                activityStatus.textContent = activity;
                
                const activityEl = card.querySelector('.activity');
                if (activity === 'Active' || activity === 'Busy' || activity === 'Emergency') {
                    activityEl.classList.add('active');
                } else {
                    activityEl.classList.remove('active');
                }
            });
        }

        // Clock and date functions
        function updateDateTime() {
            const now = new Date();
            currentTime.textContent = now.toLocaleTimeString();
            currentDate.textContent = now.toLocaleDateString();
        }

        function startClock() {
            setInterval(updateDateTime, 1000);
        }

        // Get location
        function getLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    position => {
                        const { latitude, longitude } = position.coords;
                        // In a real app, you'd reverse geocode these coordinates
                        currentLocation.textContent = 'Washington State';
                    },
                    error => {
                        currentLocation.textContent = 'Washington State';
                        console.log('Location error:', error);
                    }
                );
            } else {
                currentLocation.textContent = 'Washington State';
            }
        }

        // Initialize the app
        init();
        
        // Update station data every 30 seconds
        setInterval(updateStationData, 30000);
    </script>
</body>
</html> 
